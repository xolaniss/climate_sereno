---
format:
  pdf:
    tbl-cap-location: top
    dpi: 500
    fig-pos: "H"
    number-sections: true
    cite-method: natbib
    include-in-header: 
      - text: |
          \usepackage{lscape}
          \newcommand{\blandscape}{\begin{landscape}}
          \newcommand{\elandscape}{\end{landscape}}
          \usepackage{rotating}
          \newcommand{\bsideways}{\begin{sidewaystable}[htbp]}
          \newcommand{\esideways}{\end{sidewaystable}}
      - file: preamble.tex 
    include-before-body: title.tex
    keep-tex: TRUE
  docx:
    reference-doc: new_template_no_numbering.docx
pdf-engine: lualatex
# monofont: "DejaVu Sans Mono"
# mainfont: "Times New Roman"
execute: 
  echo: false
  warning: false
editor: source
bibliography: references.bib
biblio-style: apalike
natbiboptions: round
link-citations: true
linkcolor: blue!100!black
urlcolor: blue!100!black
citecolor: blue!100!black
linestretch: 1.5
indent: TRUE
title-block-banner: false
title-block-style: none
---


```{r setup}
#| include=FALSE
options(scipen=999)
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE, 
                      dpi = 500, 
                      fig.pos = "H", 
                      fig.env= 'figure', 
                      tab.topcaption = TRUE,
                      ft.align = "left",
                      ft.arraystretch = 0.5
                      )
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)

set_flextable_defaults(
  font.size = 7,
  digits = 2,
  font.family = "Arial",
  border.color = "black",
  border.width = 0.5,
  fp_border = fp_border(color = "black", width = 0.5, style = "solid")
)

options(scipen = 999) # disable scientific notation
```

```{r functions}
source(here("Functions","flextable_word.R" ))
source(here("Functions","modelsummary_word.R" ))
source(here("Functions","modelplot_word.R" ))
source(here("Functions","borderlines.R" ))
```

# Introduction
The post-pandemic surge of inflation to a four-decade high in many advanced and emerging markets has renewed interest in the drivers of aggregate inflation and prompted questions on the optimal response of the monetary authorities to deviations from target (ref: Chris Giles, FT). While the consensus is strong with respect to the need for curbing excess demand-pull inflation by means of monetary tightening, adverse supply shocks that push prices up and output down create difficult policy trade-offs [@klomp2020]. A key tenet of modern monetary policymaking under flexible average inflation-targeting regimes is indeed to “look through” transitory trade-off inducing supply shocks, especially if originated in specific markets, unless their persistence threatens the stability of expectations and inflation to become entrenched (…). On these lines, although the recent inflationary episode was supposedly driven by a series of idiosyncratic developments - namely, supply-chain bottlenecks, changes in relative prices, and Russia’s invasion of Ukraine, possibly exacerbated by firms’ excessive market power [@stiglitz2023] - central banks have responded by sustaining high interest rates purportedly to slay aggregate demand.
In the latest BIS annual report, such forceful global tightening action is celebrated for it sent “a strong signal to markets, firms and workers that the central bank would do what it took to restore price stability” (BIS 2024, p.  …). As a result, “inflation is now again returning to the price stability region while economic activity and labour markets have proved resilient” (idib., p.  …). In academic circles, however, the firm adoption of a contractionary stance is generally seen as a blunt and unnecessarily costly revival of the monetarist doctrine, which overshadows alternative instruments of price stabilisation [see, for example, @stiglitz2023; @weber2023]. Correctly identifying the origins of inflation (along with producing reliable forecasts and indicators of future expectations) is key to tailoring an appropriate policy response.

As these shocks wane and inflation comes down, the two narratives on the origins of inflation remain appropriate in the context of another, increasingly concerning, source of future uncertainty. Climate change is an accelerating process that is expected to increase the frequency and intensity of both acute physical hazards (i.e., droughts, floods, wildfires, heatwaves, etc.) and chronic deviations of meteorological variables from historical means (i.e., rising averages in temperature and precipitation) (IPCC 2021). The physical risks deriving from these phenomena influence agents’ preferences and endowments with immediate implications for the price stability mandate of central banks around the world through a variety of supply- and demand-side channels (we review them in Section 2). In contrast to the longer-run changes in climatic trends which influence the optimal monetary policy and r-star [@mukherjee2021], extreme climatic events “are largely unpredictable and thereby bear resemblance to other shocks that unfold over the business cycle and to which monetary policymakers tend to adjust monetary policy” (NGFS, 2024, p. 7). Either way, climate change is flaring up the debate over whether policymakers should respond to climate-induced inflationary pressures in the same old way — by vigorous monetary tightening.

This paper aims to contribute to this discussion by providing new evidence on the effect of acute climatic events on inflation employing a global panel dataset of monthly country-sector inflation from 2000 to 2023. We add to existing studies in several ways.
First, we zoom in on 12 Consumer Price sub-indexes  and 6 PPI sub-categories to disentangle the idiosyncratic nature (sectoral, cost-push vs demand-pull) of the impact of acute physical hazards (i.e., deviations in rainfall, temperature, and dryness).^[We use the COICOP price classification, that is a United Nations international reference framework for grouping household consumption expenditures on goods and services within homogeneous categories (UNSD, 1991).] 
Secondly, we acknowledge the importance of the production network in the propagation of price spillovers and aggregate inflation dynamics. While there is broad agreement that the degree to which sectoral prices respond to shocks is determined by the input-output structure of the economy, there is no evidence for the transmission mechanisms responsible for the inflationary effects of climate change. To fill this gap, we build upon the literature on sectoral propagation of shocks (…), recently applied to assess the impact of weather shocks and sectoral productivity by @zappala2024, to develop an input-output framework that factors in the indirect price spillover effects of weather shocks.
In addition, we follow current developments in the scholarship on inflation determinants by accounting for possible moderating and mediating factors, such as the role of sectoral competition in the price setting mechanism [@weber2023] and the monetary policy stance. 

While the empirical analysis is global in essence, the econometric model will be also specified as a country-specific regression to examine the experience of a single economy: we choose South Africa. Southern Africa is a climate-sensitive region that is already experiencing significant deviations of rainfall and temperatures from long-term averages as well as severe droughts and floods (World Bank Climate Portal 2024), with implications for water availability and food security. From a socio-economic perspective, however, South Africa is the strongest country in the region, exhibiting a solid infrastructure and a well-diversified and emerging open economy fully integrated to global supply chains. Moreover, what makes South Africa a good case study is its high levels of market concentration and product regulation to validate the existence of profit-led inflation. 

Notably, our sectoral approach does not downplay the macroeconomic relevance of climate risk. On the contrary, shedding light on how climate change affects specific segments of the economy and spills over to other sectors is key to understand macroeconomic processes, such as the underlying nature of aggregate inflation, and to envisage tailored policy responses. Relative price changes are also fundamental to the analysis of welfare costs, as heterogeneous households face different inflation rates depending on their income, wealth, and composition of their consumption basket (…). Thus, despite their merits, not only aggregate indexes can potentially smoothen out the variance from several inflation components, but they also conceal the true inflation costs that different consumers within the same country are susceptible to. Similarly, we are aware that a possible limitation of our study derives from the risk country-level data veil some of the localised effects of changing weather conditions but, even so, the sectoral dimension should be sufficiently sensible.^[If, for example, the shock hits only one of the nine provinces of South Africa, and raises food prices there, local food inflation will show up in the national food price index if the affected province’s food sector has a large enough share or if it travels to other regions through intra-national trade. If, instead, the local sector share is negligible (price-taker), local inflation is likely to disappear.]  

Finally, the present analysis is limited to ‘climateflation’, first defined by @schnabel2022  to conceptualise the ways in which physical risks caused by climate change put upside pressure on prices. In particular, we focus here on a wide range of acute severe climatic events. Other aspects are important in determining the relation between weather and price movements, such as the impact of chronic rises in temperature averages, climate adaptation and mitigation policies, but these are beyond the scope of this paper. 


# Climateflation: A literature review
The past few years have witnessed growing efforts of the research community towards the empirical assessment of the socio-economic effects of climate change. Although the causal relation between climate and prices remains understudied, existing empirical works find that the response of aggregate inflation to climate change is varied. @parker2018 and @cevik2023 highlight the importance of the type of climate-induced natural disaster, the country’s level of development and fiscal space in determining the direction and size of the inflation effect whereas, focusing at the effects of temperature deviations, @mukherjee2021 and @kotz2024 document rising and persistent inflation, especially in lower-income countries. 

Along with the diversity of climate-induced shocks, also the channels of price transmission are multiple and convoluted: for example, shocks can hit the supply or demand-side of the economy, directly or indirectly, they can be physical or non-physical, sudden or progressive, and they can travel upstream or downstream the economic system. This mix of possibilities means “no two physical hazard events have the same macroeconomic effects“ (NGFS 2024, p. 9) and that different weather shocks will likely hit different segments of the economy, often unevenly, causing volatility both in nominal and relative prices [@buelens2024]. We attempt to conceptualise the mechanisms behind climateflation here.
Climate-induced supply shocks. On the supply side, the climate influences some of the characteristics and effective availability of productive factors – such as impoverishment of natural resources, a more rapid depreciation of capital endowments, or reduction in labour - and total factor productivity, that encapsulates the role of technology, financing conditions, infrastructure, supply chain disruptions, etc. (NGFS, 2024). 

Sectors characterised by an inherent exposure to weather-based risk are particularly sensitive to the direct effect of local weather shocks. In farming, for example, changes in weather conditions impact negatively on agricultural productivity through workers’ heat stress [@delima2021], environmental degradation affecting crops and animal breeding [@liang2017] or increased use of pesticides and overall production costs (Savage 2024). Many authors have focused on the climate-food prices relationship. @faccia2021 find that upward temperature anomalies have an immediate impact on food prices; @kotz2024 observe that the effects of global warming are strongest in the food component of inflation; Roberts and Schlenker (2013) find that crop yields are humped-shaped, with higher temperatures increasing yields up until a threshold, before having increasingly negative effects. Finally, according to Parker (2016) storms and floods lead to a short-lived but upward effect on food price inflation.

As the climate warms, disruptions in the water cycle are likely to hit water-intensive sectors, including not only agriculture but also electricity, manufacturing, and waterway transport [@buelens2024]. Also, the higher demand for energy for cooling and warming, as climate becomes extreme, will increase its price as well as the chances of power disruptions [@mukherjee2021]. An additional direct impact is observed in the NGFS (2023)’s report and relates to damages inflicted on ecosystems resulting in the loss of services, such as touristic, from these systems. 

Direct adverse effects on productivity can also emerge due to reduced number of working hours or to presenteeism, due to heat stress and impaired health conditions among others (Graff Zivin et al. 2018, ILO 2019, Nath 2020, Pinna Pintor et al. 2024). Lower labour productivity can result in non-agricultural sectors too, particularly in presence of outdoor work (e.g. construction, tourism), but also in indoor settings (e.g. factories or offices) (ILO 2019). Acevedo et al. (2020) documents that higher temperatures significantly lower labour productivity in heat-exposed sectors but they have no significant effect in non-heat exposed industries, including in hot climate countries. Some authors additionally highlight the presence of seasonally heterogenous pressures, such that increases in hotter months and regions reduce the growth rate of labour productivity and GDP [@colacito2019] and possibly cause larger inflationary impacts [@kotz2024], while warmer winter temperatures are associated with lower energy prices. Reduction in total factor productivity [@letta2019], or damages and faster depreciation of capital assets [@bakkensen2018] have also been documented. 

In all these cases, higher costs of production in the affected sectors are transmitted downstream as higher end-user and wholesale prices.
There is a growing body of literature that highlights the role of economic networks, where shocks that hit sectors or firms propagate through input-output linkages leading to large aggregate effects.^[See Long and Plosser (1983); Shea (2002); Gabaix (2011); Acemoglu et al. (2012); Di Giovanni et al. (2014); Acemoglu et al. (2016); Magerman et al. (2016); Grassi (2017); Huneeus (2018); Lim (2018); Baqaee and Farhi (2019).] @acemoglu2012 show that in the presence of intersectoral input–output linkages, microeconomic idiosyncratic shocks may lead to “cascade effects” whereby productivity shocks to a sector located in the early stages of the supply chain propagate not only to its immediate downstream customers, but also to the rest of the economy. @dewinne2018 find that adverse weather impacts on agricultural production and food commodity prices can depress economic activity worldwide, including in high-income countries. @zappala2024 uses the input-output framework to examine the productivity shock transmission across sectors and shows that, although agriculture is harmed the most and earlier, downstream sectors – even if foreign - suffer from substantial and persistent losses as a result of network effects. 

The price transmission mechanism occurs along similar lines: upstream price changes – such as in agriculture and electricity - percolate downstream: “The producer price of an industry depends on both the prices/volume of its input suppliers and sector-specific productivity shocks. (…) Price shocks in the machinery industry affects the price of motor vehicles because of the production network coefficient.” (Bilgin 2022, p. 14) Moreover, the mechanism is asymmetric because downstream prices adjust downward more rapidly than they would do upward, and at a lower passthrough rate. In contrast to production, in the inflation diffusion network the central nodes are the upstream industries that by supplying intermediate inputs to others lead to cost pass-through. The latter will be stronger if it originates in "salient" commodities (e.g. oil, food). In the euro area, @peersman2022 estimates that shifts in international food prices between 1961 and 2016, caused by harvest shocks, explain 30% of euro-area inflation volatility. Also, @ciccarelli2023 document that temperature increases raise EU inflation in food and services, possibly due to higher sensitivity of services, such as health and tourism, to food or weather. Di Giovanni et al. (2022) reveal that Euro Area inflation amplified through production networks after the pandemic. Depending on the elasticity of substitution between inputs, the reallocation of expenditure can mitigate the ripple effect of the production cost shock. If however demand remains stable, input price increases are otherwise passed on to consumers as cost-push inflation.^[If demand is perfectly elastic, producers will be forced to fully absorb the shock. On the contrary, if demand is perfectly inelastic, consumers will be forced to buy the good whatever the price is.] @weber2023 posit that in advanced economies firms with big market power have contributed to recent inflation by amplifying the initial supply disruptions in essential sectors, such as food and energy.

Overall, relative price adjustments that pass through to broad-based inflation ("first-round effects") can generate durable implications for medium-run inflation, expectations, wages ("second-round effects"), and the conduct of monetary policy [@reis2010; BIS 2022]. At the same time, as noted by NGFS (2021), more frequent climate shocks will make it more difficult to disentangle permanent from transitory shocks. Moreover, food inflation is often perceived by households as a signal of future inflation, which will be then embedded in their expectation formation. All these factors induce central banks to intervene. According to @mukherjee2021, in developing countries, price effects persist several years after the initial shock. The reasons can be multiple: first, poor integration into global markets implies weak import substitution effects (i.e., a failed local harvest is not easily substituted with food imports) and, secondly, food prices in developing countries depend on weather more than in advanced countries where the relative contribution of wages, physical capital, energy, and transport costs is substantially higher.

Climate-induced demand shocks. Beyond driving cost-push inflation up, the climate can also shift household preferences and human needs (e.g. cooling or warming) and by extension demand patterns. For example, depressed economic activity (i.e., declining income, wealth, and confidence) might cause falling prices for non-tradable sectors [@kamber2013]. Particularly in developing countries where food constitutes the largest share of the consumer basket, higher food prices reduce the money available for other items, stifling broader consumer spending. In a cross-country analysis of 48 advanced and emerging economies, @faccia2021 find that upward temperature anomalies have a swift upward effect which turns insignificant or even negative in the medium term, possibly due to lower demand. Distinguishing by type and intensity of climate shocks, @Kabundi2022 find that, while droughts tend to push inflation up because of rising food prices, floods curb demand and so inflation. In the aftermath of a weather shock, consumption patterns may adapt in ways that prompt relative price fluctuations among sectors, such as from hospitality and travel to technology. Explained in @fig-flowchart.

In contrast to the spillover effects of supply-side shocks, demand shocks do not give rise to price transmission from customers to suppliers despite the presence of sectoral interlinkages:  for example, if as a result of a weather shock consumers’ demand for hospitality falls, this will likely affect the price of the focal sector (i.e., hospitality sector) without altering the price of its suppliers (i.e. food or construction industry).^[A few authors study demand shocks’ transmission across sectoral production and highlight specific conditions whereby upstream propagation may arise (Acemoglu et al. 2012, Arata and Miyakawa 2022).] 

Furthermore, Ferrante et al (2023) note that the post-pandemic inflationary effects of the demand reallocation from services to goods were amplified by the sectoral heterogeneity in price rigidity: industries that produce goods have more flexible prices than those that produce services and so service-producing sectors reduce production swiftly, with only modest declines in prices. Thus, another important question to understand the origins of aggregate inflation is whether climate change spurs demand in sectors with relatively more flexible prices than shrinking sectors.

```{r}
#| label: fig-flowchart
#| fig-cap: Flow chart of price propagation from weather shocks
#| fig-pos: h
#| fig-width: 20
#| fig-height: 4

knitr::include_graphics("flow_chart.png", dpi = 300)

```

In summary, a weather shock translates into idiosyncratic inflation via three channels: (i) on the demand-side, the price effect is ambiguous and depends on the sector-specific demand response to the weather shock; on the supply-side, (ii) a sector-specific weather shock changes the price in that sector directly and, lastly, (iii) by affecting the price of any other sector that supply inputs to the focal sector, it travels downstream (network weather shock). The cross-sector sum of these effects will result into aggregate inflation.

Given the complex interplay of upward and downward forces on prices, the overall reaction of inflation to weather shocks depends on which countervailing dynamic dominates [@parker2018]. Moreover, “a negligible or null effect of local weather shocks on a given sector may be amplified or mitigated by weather shocks hitting other sectors with strong commercial inter linkages” [@zappala2024]. Climate change is therefore highly sectoral by nature.


# Data 

## Prices
We build a global dataset of monthly Consumer Price indexes and sectoral sub-indexes sourced from Haver Analytics. We use non-seasonally adjusted data due to better coverage and we remove seasonal effects. By matching the 12 CPI categories  which classify consumer expenditure to the standard taxonomy of industrial sectors (UN 2008), we derive sectoral retail prices – see @tbl-cpi_matching.^[We exclude ‘Alcohol and Tobacco’ prices as well as ‘Other’ prices due to the impossibility of properly matching these products to a particular industrial sector.] Our sample covers 151 countries from January 1980 to December 2023; however, to make the panel more balanced, we restrict the analysis to the period 2000-2023 (details on data availability per country-sector are in Table A1 in the Appendix). 


```{r}
#| label: tbl-cpi_matching
#| tbl-cap: Matching price categories to industrial sectors

tribble( ~"No.", ~"CPI category", ~"Industry Classification",
          "1", "Headline", "All economic activities",
          "2", "Energy", "Electricity, gas, steam and air conditioning supply", 
          "3", "Food and Beverages", "Agriculture, forestry and fishing",
          "4", "Clothing", "Manufacturing",
          "5", "Housing", "Real estate activities",
          "6", "Household goods", "Manufacturing",
          "7", "Transport", "Transportation and storage",
          "8", "Health", "Human health and social work activities",
          "9", "Recreation", "Arts, entertainment and recreation",
          "10", "Education", "Education",
          "11", "Communication", "Information and communication",
          "12", "Hotels", "Accommodation and food service activities"
) %>% 
  flextable_word() %>% 
  align(align = "left", part = "all") %>% 
  autofit(add_w = 0.6)


```


## Weather shocks
To account for the sector-specific exposure to weather shocks, @zappala2024 weighs grid-cell data by the proportion of agricultural and non-agricultural economic activities. Hence, to measure the exposure of the agricultural sector, grid-cell data is weighted by the proportion of each grid cell under cropland using the Global Agricultural Lands dataset [@ramankutty2010]. In all other sectors, such granular information is not available and so exposure is accounted by aggregating grid-cell level information weighted by population weights from the Landscan dataset (Bright and Coleman, 2001).

## Input-output linkages


# Methodology
We build on the network econometrics methodology of @acemoglu2016, who develop an empirical framework to study the impact of various types of domestic shocks, and the applications by @zappala2024  and @das2021.

## Identification of climate-induced network shocks.
In our analysis of inflation propagation, network shocks are computed from the interaction of the vector of weather shocks hitting a specific sector in the global production network and a vector of downstream weights reflecting the focal sector’s input purchases from other sectors j. Hence, these network shocks can be domestic ($W_{s,c,t}^D$) and foreign ($W_{s,c,t}^F$) based on the supplier’s origin with respect to the focal sector and they will only propagate downstream. 

$$
W_{s,c,t}^D = \sum_{j \neq s} w_{sc,jc,t}^D W_{s,c,t} , \text{where} \quad w_{sc,jc,t}^D = \frac{input_{jc \rightarrow sc,t}}{total input_{all \rightarrow s,t}}, and
$$ {#eq-dom_net_shock}

$$
W_{s,c,t}^F = \sum_j \sum_{k \neq c} w_{sc,jk,t}^F W_{k,t} , \text{where} \quad w_{sc,jk,t}^F = \frac{input_{jc \rightarrow sk,t}}{total input_{all \rightarrow s,t}}.
$$ {#eq-foreign_net_shock}


$w_{sc, jc, t}^D$ amd $w_{sc, jk, t}^F$ are coefficients of the Leontief matrix, defined as the input share going from sector $j$ in country $c$ or $k$ (depending on whether the weather shock is foreign or domestic) to the focal sector $s$ in country $c$ at time $t$. Thus, each network shock can affect the focal sector to the extent of its input purchases from the affected sector. The sectoral transmission depends, therefore, on the relative importance of each supplier sector for the focal sector.

Finally, the total network shock is defined as the sum of the network shocks:
$$
W_{s,c,t}^{Tot} = W_{s,c,t}^D+ W_{s,c,t}^F
$$ {#eq-total_net_shock}

## Econometric modelling 

We quantify the relative importance and persistence of the two channels of transmission of the weather shock - direct and network – on sectoral inflation by estimating a heterogeneous 3D fixed-effect model (@eq-inflation) and impulse response functions by local projections (@eq-h_inflation): 


$$
\pi_{s,c,t} = \alpha\pi_{s,c,t-1} + \beta_SW_{s,c,t} + \sum_n\beta_n W_{s,c,t}^n + \Gamma_{s,c}+ \gamma_{s,t}+ \epsilon_{s,c,t}		
$$ {#eq-inflation}

$$
\pi_{s,c,t+h} = \beta_{s}^h W_{s,c,t} + \sum_n\beta_n^hW_{s,c,t}^n + \Gamma_{s,c} + \gamma_{s,t+h} + \epsilon_{s,c,t+h}				
$$ {#eq-h_inflation}


The dependent variable $\pi_{s,c,t}$ is inflation in product category (or sector) $s$ in country $c$ and time $t$, measured as the growth rate of the price level, such that $s$ = (PPI and sub-indices, CPI and sub-indices). 

On the right side, the first term $\pi_{s,c,t-1}$ is past inflation  (given inflation expectations are not available at sectoral level); the variable $W_{c,t}$ measures the weather shock hitting country $c$ at time $t$, while the $\beta_s$ coefficients are heterogeneous slopes  – which are estimated jointly in a fully saturated model – representing the sector-specific direct effect of weather shocks on inflation and allow us to observe the differential responses by sector; in other words, if $\beta_s$ is statistically significant, then the weather shock $W_{c,t}$ has a direct price effect on the focal sector $s$ in country $c$ at time $t$. 

The second term on the right side captures the spillover or network effect, that is the response of sectoral inflation to the weather shock working through the global production network. In the regressions, we consider each of the three network shocks defined above, such that $n = 𝐷, F, 𝑇𝑜𝑡$. The relative impact that shocks originating in different parts of the network have on a sector’s inflation are given by the estimates of $\beta_j$. In order to make meaningful comparisons across those coefficients, each shock variable $W_t^j$is divided by its own standard deviation.

We include country-sector fixed effects to account for the time-invariant unobserved heterogeneity of each sector in each country, like the capacity constraints of electricity production in South Africa and the labour productivity of the manufacturing sector in China, that influence countries’ average sectoral inflation; the inclusion of spatial effects also allows us to disentangle plausibly random weather fluctuations from long-term climate, which is likely correlated with other socio economic characteristics. Sector-month fixed effects instead capture sector-specific time trends, such as technological innovations, or shocks, such as the 2008 financial crisis, Russia’s invasion of Ukraine, or El Niño events. 

Standard errors are clustered at the country level to account for spatial correlation of the error terms across sectors in the same country over time. Finally, $\epsilon_{s,c,t}$ is the error term. For robustness purposes, additional specifications of @eq-inflation and @eq-h_inflation will include country time trends while another version will exclude network shocks and other controls to gauge the importance of both in the estimate of direct effects .

## Extensions

The effect of monetary policy can also be accounted for by dividing our sample into inflation-targeting and non-inflation-targeting countries using the information from Fratzscher et al. (2020). Alternatively, the moderating effect of monetary policy on aggregate inflation can be integrated by multiplying the weather shock by the real interest rate change.

## Climateflation in South Africa
In the last step, we repeat the above estimations by narrowing down the focus on South Africa. To this end, we adjust @eq-inflation and @eq-h_inflation, such that $c = South Africa$ and @eq-sa_inflation and @eq-sa_h_inflation are cross-sector panel data regressions.

$$
\pi_{s,t} = \beta_sW_t + \sum_{j\neq s} \beta_j W_{s,t}^j + \Gamma_s + \gamma_{s,t} + \epsilon_{s,t}					
$$ {#eq-sa_inflation}

$$
\pi_{s,t+h} = \beta_s^h W_t+ \sum_{j \neq s} \beta_j^h W_{s,t}^j + \Gamma_{s} + \gamma_{s,t+h} + \epsilon_{s,t+h}		
$$ {#eq-sa_h_inflation}


To test whether sectoral market competition/concentration influences the extent to which weather shocks impact prices [@weber2023], we will extend the above by interacting the weather variable with a measure of industry concentration in South Africa, such as the Herfindahl-Hirschman Index, or sectoral profits-to-GVA.



# Results


# Conclusion

\newpage 
# References {.unnumbered}
::: {#refs}
:::


\setcounter{section}{0}
\renewcommand{\thesection}{\Alph{section}}

\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}

\setcounter{figure}{0}
\renewcommand{\thefigure}{A\arabic{figure}}

\newpage

# Appendix


## Inflation rates

```{r}
#| label: tbl-inflation_summary
#| tbl-cap: "Summary statistics of sectoral inflation rates (%)"
#| ft.arraystretch: 0.6

inflation_tbl <- read_rds(here("Outputs", "artifacts_inflation_rate.rds")) |> 
  pluck(1) |> 
  filter(date >= "2000-01-01") 

inflation_summary_tbl <- 
  inflation_tbl |>
  filter(industry == "Headline") |>
  drop_na(inflation_rate) |>
  group_by(industry) |>
  summarise(
    Mean = mean(inflation_rate, na.rm = TRUE),
    SD = sd(inflation_rate, na.rm = TRUE),
    Min = min(inflation_rate, na.rm = TRUE),
    Max = max(inflation_rate, na.rm = TRUE),
    Observations = n()
  ) 

inflation_sector_summary_tbl <- 
  inflation_tbl |>
  filter(industry != "Headline") |>
  drop_na(inflation_rate) |>
  group_by(industry) |>
  summarise(
    Mean = mean(inflation_rate, na.rm = TRUE),
    SD = sd(inflation_rate, na.rm = TRUE),
    Min = min(inflation_rate, na.rm = TRUE),
    Max = max(inflation_rate, na.rm = TRUE),
    Observations = n()
  ) 


inflation_summary_tbl |>
  bind_rows(inflation_sector_summary_tbl)|>
  rename(
    "Sector" = industry,
    "Mean" = Mean,
    "Standard Deviation" = SD,
    "Minimum" = Min,
    "Maximum" = Max,
    "Observations" = Observations
  ) |> 
  mutate(
    Sector =
      case_when(
        Sector == "headline" ~ "Headline",
        Sector == "energy" ~ "Energy",
        Sector == "agrifood" ~ "Agri-food",
        Sector == "clothing" ~ "Clothing",
        Sector == "housing" ~ "Housing",
        Sector == "household_goods" ~ "Household Goods",
        Sector == "transport" ~ "Transport",
        Sector == "health" ~ "Health",
        Sector == "recreation" ~ "Recreation",
        Sector == "education" ~ "Education",
        Sector == "communications" ~ "Communications",
        Sector == "hotels" ~ "Hotels"
      )
  ) |>
  flextable_word() |>
  align(align = "left", part = "all") |>
  autofit(add_w = 0.2)

```

\newpage

## Countries and month-sectors in sample

```{r}
#| label: tbl-countries_month_sectors
#| tbl-cap: "Countries and month-sectors in the sample"
#| ft.arraystretch: 0.4

library(countrycode)

inflation_tbl |>
  filter(industry != "Hseadline") |>
  mutate(country = countrycode(country, "iso3c", "country.name")) |>
  drop_na() |> 
  group_by(country) |>  
  count() |> 
  rename(    
    "Country" = country,
    "Number of month-sectors" = n
  ) |>
  ungroup() |> 
  flextable_word() |>
  align(align = "left", part = "all") |>
  align(align = "center", j =2, part = "all") |>
  autofit(add_w = 2)



```


\newpage

## Climate shocks

```{r}
#| label: tbl-climate_shocks
#| tbl-cap: "Summary statistics of climate shocks"
#| ft.arraystretch: 0.6


climate_shocks_tbl <- read_rds(here("Outputs", "artifacts_climate_shocks.rds")) |> pluck(1)

climate_summary_tbl <- 
  climate_shocks_tbl |>
  dplyr::select(contains("_anomaly"), country, date) |> 
  pivot_longer(
    cols = -c(country, date),
    names_to = "variable",
    values_to = "value"
  ) |>
  drop_na(value) |>
  group_by(variable) |>
  summarise(
    Mean = mean(value, na.rm = TRUE),
    SD = sd(value, na.rm = TRUE),
    Min = min(value, na.rm = TRUE),
    Max = max(value, na.rm = TRUE),
    Observations = n()
  ) |> 
  mutate(
    variable = 
      case_when(
        variable == "land_weighted_temp_anomaly" ~ "Land-weighted temperature (deviation from mean)",
        variable == "population_weighted_temp_anomaly" ~ "Population-weighted temperature (deviation from mean) ",
        variable == "land_weighted_precip_anomaly" ~ "Land-weighted precipitation (deviation from mean) ",
        variable == "population_weighted_precip_anomaly" ~ "Population-weighted precipitation (deviation from mean) "
      )
  )

climate_summary_tbl


extreme_descriptives <- 
  function(data, variable, anomaly){
  data |> 
    filter({{variable}} == "Yes") |> 
    dplyr::select(date, country, {{anomaly}}) |>
    drop_na() |> 
    summarise(
      Mean = mean({{anomaly}}, na.rm = TRUE),
      SD = sd({{anomaly}}, na.rm = TRUE),
      Min = min({{anomaly}}, na.rm = TRUE),
      Max = max({{anomaly}}, na.rm = TRUE),
      Observations = n()
  )
}

extreme_vars <- list(
  c("land_weighted_temp_extreme_p_0.9", "land_weighted_temp_anomaly"),
  c("land_weighted_temp_extreme_p_0.1", "land_weighted_temp_anomaly"),
  c("land_weighted_precip_extreme_p_0.9", "land_weighted_precip_anomaly"),
  c("land_weighted_precip_extreme_p_0.1", "land_weighted_precip_anomaly"),
  
  c("population_weighted_temp_extreme_p_0.9", "population_weighted_temp_anomaly"),
  c("population_weighted_temp_extreme_p_0.1", "population_weighted_temp_anomaly"),
  c("population_weighted_precip_extreme_p_0.9", "population_weighted_precip_anomaly"),
  c("population_weighted_precip_extreme_p_0.1", "population_weighted_precip_anomaly"),
  
  c("land_weighted_temp_extreme_p_0.95", "land_weighted_temp_anomaly"),
  c("land_weighted_temp_extreme_p_0.05", "land_weighted_temp_anomaly"),
  c("land_weighted_precip_extreme_p_0.95", "land_weighted_precip_anomaly"),
  c("land_weighted_precip_extreme_p_0.05", "land_weighted_precip_anomaly"),

  c("population_weighted_temp_extreme_p_0.95", "population_weighted_temp_anomaly"),
  c("population_weighted_temp_extreme_p_0.05", "population_weighted_temp_anomaly"),
  c("population_weighted_precip_extreme_p_0.95", "population_weighted_precip_anomaly"),
  c("population_weighted_precip_extreme_p_0.05", "population_weighted_precip_anomaly"),
  
  c("land_weighted_temp_extreme_p_0.99", "land_weighted_temp_anomaly"),
  c("land_weighted_temp_extreme_p_0.01", "land_weighted_temp_anomaly"),
  c("land_weighted_precip_extreme_p_0.99", "land_weighted_precip_anomaly"),
  c("land_weighted_precip_extreme_p_0.01", "land_weighted_precip_anomaly"),

  
  c("population_weighted_temp_extreme_p_0.99", "population_weighted_temp_anomaly"),
  c("population_weighted_temp_extreme_p_0.01", "population_weighted_temp_anomaly"),
  c("population_weighted_temp_extreme_p_0.99", "population_weighted_temp_anomaly"),
  c("population_weighted_temp_extreme_p_0.01", "population_weighted_temp_anomaly")
)

extreme_descriptives_tbl <- 
  extreme_vars |> 
  map(~ extreme_descriptives(
    data = climate_shocks_tbl, 
    variable = !!sym(.x[1]),
    anomaly = !!sym(.x[2])
    )) |> 
  bind_rows(.id = "variable") |> 
  mutate(
    variable = 
      case_when(
        variable == "1" ~ "Land-weighted temperature shock (90th percentile)",
        variable == "2" ~ "Land-weighted temperature shock (10th percentile)",
        variable == "3" ~ "Land-weighted precipitation shock (90th percentile)",
        variable == "4" ~ "Land-weighted precipitation shock (10th percentile)",
        
        variable == "5" ~ "Population-weighted temperature shock (90th percentile)",
        variable == "6" ~ "Population-weighted temperature shock (10th percentile)",
        variable == "7" ~ "Population-weighted precipitation shock (90th percentile)",
        variable == "8" ~ "Population-weighted precipitation shock (10th percentile)",
        
        variable == "9" ~ "Land-weighted temperature shock (95th percentile)",
        variable == "10" ~ "Land-weighted temperature shock (5th percentile)",
        variable == "11" ~ "Land-weighted precipitation shock (95th percentile)",
        variable == "12" ~ "Land-weighted precipitation shock (5th percentile)",

        variable == "13" ~ "Population-weighted temperature shock (95th percentile)",
        variable == "14" ~ "Population-weighted temperature shock (5th percentile)",
        variable == "15" ~ "Population-weighted precipitation shock (95th percentile)",
        variable == "16" ~ "Population-weighted precipitation shock (5th percentile",
        
        variable == "17" ~ "Land-weighted temperature shock (99th percentile)",
        variable == "18" ~ "Land-weighted temperature shock (1st percentile)",
        variable == "19" ~ "Land-weighted precipitation shock (99th percentile",
        variable == "20" ~ "Land-weighted precipitation shock (1st percentile)",
        
        variable == "21" ~ "Population-weighted temperature shock (99th percentile)",
        variable == "22" ~ "Population-weighted temperature shock (1st percentile)",
        variable == "23" ~ "Population-weighted precipitation shock (99th percentile)",
        variable == "24" ~ "Population-weighted precipitation shock (1st percentile)"
     
      )
  ) 
  
  
climate_summary_tbl |> 
  bind_rows(extreme_descriptives_tbl) |> 
  mutate(group = ifelse(
    str_detect(variable, "temperature"), "Temperature (°C)",  "Precipitation (mm)")
  ) |> 
  relocate(group, .before = variable)  |>
  arrange(group) |> 
  rename(
    "Variable" = variable,
    "Mean" = Mean,
    "Standard Deviation" = SD,
    "Minimum" = Min,
    "Maximum" = Max,
    "Observations" = Observations
  ) |>
  as_grouped_data(groups = c("group"), expand_single = TRUE) |> 
  as_flextable(hide_grouplabel = TRUE) |> 
  align(align = "center", part = "body") |> 
  align(align = "left", j = 1, part = "all") |> 
  align(align = "center", i = c(1, 16)) |>
  colformat_double(j = 2:6, digits = 2) |>
  autofit(add_w = -0.05) 
  


```

\newpage
## Matching sectoral price and IO data

```{r}
#| label: tbl-sectoral_matching
#| tbl-cap: "Matching sectoral price and Input-output data (Eora26)"
#| ft.arraystretch: 0.6

tribble(
  ~ "Price Index", ~ "Input-output classifation",  ~ "Input-output Sector",
  "Headline", "1-26", "All sectors",
  "Energy", "7,13", "Petroleum, Chemical and Non-Metallic Mineral Products, Electricity, Gas and Water",
  "Food and Beverages",	"1, 2, 4", "Agriculture, Fishing, Food & Beverages",
  "Clothing",	"5", "Textiles and Wearing Apparel",
  "Housing",	"14, 15", "Construction, Maintenance and repair",
  "Household goods", "6, 9, 11",	"Wood and paper, Electrical and machinery, Other manufacturing",
  "Transport", "10, 19",	"Transport equipment, Transport",
  "Health",	"23", "Education, Health and Other Services",
  "Education",	"23", "Education, Health and Other Services",
  "Communication",	"20", "Post and Telecommunications",
  "Hotels","18",	"Hotels and Restaurants"
) |> 
  flextable_word() |> 
  align(align = "left", part = "all") |> 
  autofit(add_w = 0.6) |> 
  set_header_labels(
    `Price Index` = "Price Index",
    `Input-output classifation` = "Input-output classifation",
    `Input-output Sector` = "Input-output Sector"
  ) |> 
  autofit(add_w = 0.)


```

\newpage

## Stationarity tests

```{r}
#| label: tbl-stationarity_tests
#| tbl-cap: "Im-Pesaran-Shin unit-root test for main variables"
#| ft.arraystretch: 0.6
#| ft.font.size: 10

inflation_stationarity_list <- read_rds(here("Outputs", "artifacts_inflation_stationarity.rds")) |> 
  pluck(1)
climate_shocks_stationarity_list <- read_rds(here("Outputs", "artifacts_shocks_stationarity.rds")) |> 
  pluck(1)

inflation_stationarity_tbl <- 
  tibble(
    "variable" = "Inflation rate",
    "Statistic" = inflation_stationarity_list$statistic$statistic,
    "p-value" = inflation_stationarity_list$statistic$p.value
  )

climate_statistics_tbl <- 
  climate_shocks_stationarity_list |> 
  map(~ .x$statistic$statistic) |> 
  unlist() |> 
  round(2) |> 
  as_tibble()

climate_pvalues_tbl <-
  climate_shocks_stationarity_list |> 
  map(~ .x$statistic$p.value) |> 
  unlist() |> 
  as_tibble()

climate_stationarity_tbl <- 
  bind_cols(
  climate_statistics_tbl,
  climate_pvalues_tbl
) |> 
  rename(
    "Statistic" = value...1,
    "p-value" = value...2
  ) |> 
  mutate(
    variable = c(
      # Population
      "Abnormally cold temperature shock (1st percentile)",
      "Abnormally hot temperature shock (99th percentile)",
      "Abnormally cold temperature shock (5th percentile)",
      "Abnormally hot temperature shock (95th percentile)",
      "Abnormally cold temperature shock (10th percentile)",
      "Abnormally hot temperature shock (90th percentile)",
      
      # precipitation
      "Abnormally dry precipitation shock (1st percentile)",
      "Abnormally wet precipitation shock (99th percentile)",
      "Abnormally dry precipitation shock (5th percentile)",
      "Abnormally wet precipitation shock (95th percentile)",
      "Abnormally dry precipitation shock (10th percentile)",
      "Abnormally wet precipitation shock (90th percentile)"
    )
  ) |> 
  relocate(variable, .before = Statistic) 

bind_rows(
  inflation_stationarity_tbl,
  climate_stationarity_tbl
  ) |> 
  rename(" " = variable) |> 
  flextable_word() |> 
  align(align = "left", part = "all") |> 
  align(align = "center", j = c("Statistic", "p-value"), part = "all") |> 
  colformat_double(j = c("Statistic", "p-value"), digits = 2) |> 
  autofit(add_w = 0.8)

```
